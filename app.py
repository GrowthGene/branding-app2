def generate_guide_content(guide_type: str) -> str:
    """가이드 콘텐츠 생성 함수"""
    
    if guide_type == "첫걸음":
        return """
# 🌱 인플루언서 첫걸음: 0에서 1K까지

## 📋 1단계: 매력적인 프로필 만들기 (1주차)

### 프로필 사진 최적화
- **얼굴이 명확히 보이는 사진** 선택 (70% 이상 얼굴)
- **밝고 자연스러운 표정** (미소 짓는 모습 추천)
- **고화질 이미지** 사용 (최소 400x400px)
- **개성을 보여주는 소품** 활용 (안경, 모자 등)

### 바이오 작성 공식
```
[직업/전문분야] | [관심사] | [거주지]
[개성 있는 한 줄 소개]
[연락처 또는 링크]
```

**예시:**
```
뷰티 크리에이터 | 20대 직장인 | 서울
💄 진짜 후기만 알려드려요
📩 협업 문의: example@gmail.com
```

### 하이라이트 설정
- **자기소개** (About Me)
- **일상** (Daily)
- **OOTD** (Outfit)
- **리뷰** (Review)
- **Q&A** (Questions)

---

## 📈 2단계: 첫 100명 팔로워 확보 전략 (2-4주차)

### 친구/지인 활용법
1. **개인 계정 팔로워 이전**: 기존 지인들에게 새 계정 알리기
2. **지인 태그**: 첫 게시물에 친한 친구들 태그하기
3. **스토리 공유 요청**: 친구들에게 계정 홍보 도움 요청

### 해시태그 초보자 전략
**황금 비율: 인기 해시태그 30% + 중간 해시태그 50% + 틈새 해시태그 20%**

- **인기 해시태그** (100만+ 게시물): #daily, #ootd, #selfie
- **중간 해시태그** (10만-100만): #20대, #직장인, #서울
- **틈새 해시태그** (1만-10만): #직장인스타그램, #20대일상

### 다른 계정과 교류하기
- **같은 분야 계정 팔로우**: 비슷한 콘텐츠를 하는 계정 20-30개
- **진정성 있는 댓글**: "예쁘다" 대신 구체적인 칭찬
- **스토리 반응**: 다른 계정 스토리에 적극적으로 반응

---

## 🎯 3단계: 콘텐츠 일관성 유지하기 (5-8주차)

### 콘텐츠 필러 정하기 (5개)
1. **일상 공유** (30%): 소소하지만 특별한 일상
2. **OOTD** (25%): 옷차림과 스타일링
3. **뷰티/셀프케어** (20%): 메이크업, 스킨케어
4. **맛집/카페** (15%): 방문한 장소 후기
5. **팔로워 소통** (10%): Q&A, 일상 질문

### 주간 콘텐츠 계획표
| 요일 | 콘텐츠 유형 | 예시 |
|------|-------------|------|
| 월요일 | 일상 | 월요병 극복 루틴 |
| 화요일 | OOTD | 오피스룩 스타일링 |
| 수요일 | 뷰티 | 수요일 셀프케어 |
| 목요일 | 일상 | 목요일 소소한 행복 |
| 금요일 | 맛집 | 불금 맛집 탐방 |
| 토요일 | OOTD | 주말 데이트룩 |
| 일요일 | 소통 | 일주일 하이라이트 |

### 촬영 및 편집 팁
**촬영 시간대:**
- **골든아워**: 일출/일몰 1시간 전후 (가장 예쁜 자연광)
- **실내**: 창가에서 얼굴에 그림자가 지지 않게

**기본 편집 순서:**
1. **노출 조정**: 얼굴이 잘 보이도록
2. **명도/채도**: 자연스럽게 보정
3. **필터 적용**: 일관된 톤앤매너 유지
4. **샤프닝**: 선명도 향상

---

## 📊 4단계: 성장 분석 및 개선 (9-12주차)

### 주간 성과 체크리스트
- [ ] 팔로워 증가 수: 목표 25명/주
- [ ] 평균 좋아요 수: 팔로워의 5-10%
- [ ] 스토리 조회수: 팔로워의 20-30%
- [ ] 댓글 참여율: 게시물당 3-5개

### 성장하지 않을 때 체크포인트
1. **게시 시간 조정**: 팔로워가 가장 활발한 시간대 찾기
2. **해시태그 다양화**: 매번 다른 조합 시도
3. **스토리 활용도 증가**: 일일 스토리 게시
4. **팔로워와 소통 강화**: 댓글, DM 적극 답변

### 1000명 달성 후 다음 단계
- **협찬 포트폴리오 준비**: 베스트 게시물 정리
- **브랜드 아이덴티티 명확화**: 나만의 스타일 완성
- **수익화 방안 검토**: 협찬, 제휴 기회 모색

---

## 💡 성공하는 인플루언서의 마인드셋

### DO's ✅
- **진정성 유지**: 가식적이지 않은 자연스러운 모습
- **꾸준함**: 작은 일이라도 매일 꾸준히
- **긍정적 에너지**: 팔로워에게 좋은 영향력 전달
- **학습 정신**: 새로운 트렌드와 기능에 관심

### DON'Ts ❌
- **팔로워 구매**: 일시적 효과, 참여율 하락
- **과도한 홍보**: 매 게시물마다 판매 시도
- **비교 의식**: 다른 인플루언서와 과도한 비교
- **일관성 부족**: 들쭉날쭉한 콘텐츠 품질

---

## 🚀 실전 첫 주 액션 플랜

### Day 1-2: 프로필 완성
- [ ] 프로필 사진 교체
- [ ] 바이오 작성 및 최적화
- [ ] 하이라이트 카테고리 설정

### Day 3-4: 첫 콘텐츠 제작
- [ ] 자기소개 포스트 작성
- [ ] 5개 콘텐츠 필러 소개 스토리
- [ ] 친구/지인들에게 계정 홍보

### Day 5-7: 네트워킹 시작
- [ ] 비슷한 분야 계정 20개 팔로우
- [ ] 진정성 있는 댓글 10개 이상 작성
- [ ] 첫 주간 후기 스토리 업로드

**첫 주 목표: 팔로워 50명, 첫 게시물 좋아요 20개**

이제 시작이 반입니다! 꾸준히 실행하면 분명 성과가 있을 거예요 ✨
"""

    elif guide_type == "릴스":
        return """
# 🎬 릴스 마스터하기: 바이럴 공식

## 📱 릴스 알고리즘 이해하기

### 알고리즘이 선호하는 릴스 특징
1. **완시청률** (가장 중요): 끝까지 보는 비율
2. **반복 시청률**: 여러 번 돌려보는 정도
3. **빠른 참여**: 업로드 후 30분 내 반응
4. **공유율**: DM, 스토리로 공유되는 횟수
5. **저장률**: 나중에 보기 위해 저장하는 비율

### 릴스 길이별 전략
- **15초**: 임팩트 있는 한 가지 메시지
- **30초**: 3단계 스토리텔링 (문제-과정-해결)
- **60초**: 튜토리얼, 상세한 설명
- **90초**: 깊이 있는 콘텐츠, 브이로그 스타일

---

## ⏰ 3초 법칙: 시선 사로잡기

### 강력한 오프닝 기법
1. **충격적인 질문**: "이거 몰랐으면 손해보는 거였어!"
2. **Before & After**: 극적인 변화 미리보기
3. **카운트다운**: "3가지만 알면 돼요"
4. **반전 요소**: "여러분이 생각하는 것과 달라요"
5. **긴급성**: "지금 당장 해봐야 하는 것"

### 시각적 임팩트 기법
- **클로즈업 샷**: 얼굴이나 손동작을 크게
- **빠른 컷 편집**: 2-3초마다 장면 전환
- **대비 강한 색상**: 눈에 띄는 의상/배경
- **움직임**: 정적인 장면보다 동적인 움직임

---

## 🎵 트렌딩 오디오 활용법

### 오디오 선택 기준
1. **업로드 최신성**: 24시간 내 업로드된 사운드
2. **사용량 증가세**: 급속도로 늘어나는 사용 횟수
3. **내 콘텐츠와의 적합성**: 분위기와 메시지 일치
4. **길이 적절성**: 내 콘텐츠 길이와 매치

### 트렌딩 오디오 찾는 법
1. **탐색 페이지 확인**: 인기 릴스에서 사용된 음악
2. **경쟁자 분석**: 비슷한 계정들이 사용하는 음악
3. **음악 앱 연동**: Spotify, Apple Music 트렌드 확인
4. **릴스 음악 라이브러리**: 인스타그램 추천 음악

---

## ✂️ 편집 꿀팁 5가지

### 1. 비트에 맞춘 편집
- **음악의 비트**에 맞춰 장면 전환
- **드롭 구간**에서 임팩트 있는 장면 배치
- **템포 변화**에 따른 편집 속도 조절

### 2. 텍스트 오버레이 활용
```
폰트 크기: 큰 제목 - 작은 설명
색상: 배경과 대비되는 색
위치: 얼굴을 가리지 않는 곳
타이밍: 음성과 동기화
```

### 3. 전환 효과 (Transition) 마스터
- **손으로 카메라 가리기** → 다른 장면으로 전환
- **회전하며 장면 바꾸기** → 돌아서면서 전환
- **점프컷** → 같은 자리에서 옷/표정 바뀜
- **오브젝트 매칭** → 물건으로 연결되는 전환

### 4. 속도 조절 활용
- **슬로우모션**: 중요한 순간 강조 (0.5x)
- **타임랩스**: 긴 과정을 짧게 (2-4x)
- **일반 속도**: 대화나 설명 부분 (1x)
- **속도 변화**: 비트에 맞춘 속도 변화

### 5. 클로즈업과 풀샷 조합
- **클로즈업**: 감정, 디테일 표현
- **미디엄샷**: 제스처, 표정 종합
- **풀샷**: 전체적인 상황, OOTD
- **엑스트림 클로즈업**: 제품, 텍스처

---

## 📅 업로드 최적 시간대

### 한국 기준 황금 시간대
1. **평일 저녁**: 18:00-21:00 (퇴근 후 휴식 시간)
2. **주말 오후**: 14:00-17:00 (여유로운 주말 오후)
3. **점심시간**: 12:00-13:00 (직장인 점심 휴식)

### 타겟별 최적 시간
- **10대**: 방과 후 16:00-18:00, 밤 21:00-23:00
- **20-30대**: 출근길 08:00-09:00, 퇴근길 18:00-20:00
- **주부층**: 오전 10:00-12:00, 오후 14:00-16:00

### 업로드 후 30분이 골든타임
- **즉시 친구들에게 공유** 요청
- **스토리에 릴스 공유**
- **댓글 적극 답변**
- **다른 계정들과 교류**

---

## 🏷️ 해시태그 전략

### 릴스 전용 해시태그 (필수)
```
#reels #릴스 #instareel #reelsinstagram #viral
```

### 카테고리별 해시태그
**뷰티 릴스:**
```
#뷰티 #메이크업 #뷰티팁 #makeup #beauty #skincare
#kbeauty #cosmetics #뷰티루틴 #셀프메이크업
```

**패션 릴스:**
```
#패션 #ootd #fashion #style #outfit #코디
#데일리룩 #스타일링 #패션스타그램 #옷스타그램
```

**라이프스타일 릴스:**
```
#일상 #daily #lifestyle #vlog #루틴 #데일리
#소소한일상 #일상스타그램 #감성 #힐링
```

---

## 📊 성과 분석 및 개선

### 확인해야 할 지표들
1. **조회수**: 도달범위와 알고리즘 반응
2. **완시청률**: 콘텐츠 완성도 지표
3. **좋아요 비율**: 조회수 대비 좋아요 비율
4. **댓글 참여**: 소통과 engagement
5. **공유/저장**: 콘텐츠 가치 인정도

### 성과 개선 체크리스트
**조회수가 낮다면:**
- [ ] 오프닝 3초 개선
- [ ] 트렌딩 오디오 사용
- [ ] 해시태그 다양화
- [ ] 업로드 시간 조정

**완시청률이 낮다면:**
- [ ] 릴스 길이 단축
- [ ] 불필요한 구간 편집
- [ ] 마지막까지 궁금증 유발
- [ ] 반전 요소 추가

---

## 🎬 바이럴 릴스 공식

### 황금 구성: Hook - Build - Payoff
1. **Hook (3초)**: 강력한 첫인상
2. **Build (중간)**: 긴장감과 호기심 증폭
3. **Payoff (마지막)**: 만족스러운 결론

### 바이럴 콘텐츠 유형
1. **튜토리얼**: "이렇게 하면 완전 달라져요"
2. **Before & After**: 극적인 변화
3. **꿀팁**: "이거 몰랐으면 손해"
4. **일상 반전**: "평범한 줄 알았는데..."
5. **챌린지**: 따라하기 쉬운 액션

### 실패하는 릴스의 공통점
- 첫 3초에 임팩트 없음
- 음악과 영상이 따로 놂
- 너무 길거나 지루함
- 해시태그 부족
- 화질이 떨어짐

---

## 🚀 실전 릴스 제작 체크리스트

### 기획 단계
- [ ] 타겟 오디언스 명확화
- [ ] 핵심 메시지 1개 선정
- [ ] 트렌딩 오디오 선택
- [ ] 구성안 작성 (Hook-Build-Payoff)

### 촬영 단계
- [ ] 조명 확인 (얼굴이 밝게)
- [ ] 배경 정리 (깔끔하게)
- [ ] 복수 앵글 촬영
- [ ] 여분 컷 충분히 확보

### 편집 단계
- [ ] 음악 비트에 맞춘 편집
- [ ] 텍스트 가독성 확인
- [ ] 전환 효과 자연스럽게
- [ ] 마지막 CTA 추가

### 업로드 단계
- [ ] 최적 시간대 업로드
- [ ] 해시태그 10-15개 사용
- [ ] 매력적인 캡션 작성
- [ ] 썸네일 이미지 선택

이제 당신도 바이럴 릴스를 만들 수 있습니다! 🔥
"""

    elif guide_type == "협찬":
        return """
# 💼 브랜드 협찬 받는 법: 제안서부터 협상까지

## 📈 협찬 받기 위한 기본 조건

### 팔로워 수별 협찬 가능성
- **1K-5K**: 소규모 브랜드, 제품 협찬
- **5K-10K**: 중소 브랜드, 체험단 활동
- **10K-50K**: 유명 브랜드, 정기 협찬
- **50K+**: 대기업, 장기 파트너십

### 필수 준비사항
1. **일관된 콘텐츠 품질**: 최소 3개월간 꾸준한 업로드
2. **명확한 타겟 오디언스**: 특정 연령/성별/관심사
3. **높은 참여율**: 팔로워 대비 3% 이상 참여율
4. **전문성**: 특정 분야에 대한 지식과 경험
5. **개인 브랜드**: 독특하고 기억에 남는 캐릭터

---

## 📧 브랜드 어프로치 이메일 템플릿

### 제목 라인 공식
```
[인플루언서명] X [브랜드명] 협업 제안 | 팔로워 [수]K, 참여율 [%]%
```

**예시:**
```
뷰티크리에이터 김예나 X 올리브영 협업 제안 | 팔로워 15K, 참여율 4.2%
```

### 이메일 본문 템플릿

```
안녕하세요, [브랜드명] 마케팅 담당자님

저는 [전문분야] 인플루언서 [이름]입니다.

■ 자기소개
- 인스타그램: @[계정명] (팔로워 [수]명)
- 전문분야: [뷰티/패션/라이프스타일 등]
- 주요 타겟: [20대 여성, 직장인 등]
- 평균 참여율: [%]%

■ 협업 제안 이유
[브랜드명]의 [특정 제품/서비스]에 대한 관심과 
제 팔로워들에게 도움이 될 것이라는 확신으로 연락드립니다.

■ 협업 가능 콘텐츠
1. 제품 리뷰 포스트 (피드 게시물 1개)
2. 사용 과정 릴스 (15-30초)
3. 스토리 후기 (3-5개 스토리)
4. 라이브 def show_resources():
    st.markdown('<div class="section-header"><h2>📚 인플루언서 리소스 센터</h2></div>', unsafe_allow_html=True)
    
    # 탭으로 리소스 구분
    tab1, tab2, tab3, tab4 = st.tabs(["🛠️ 필수 도구", "📖 성장 가이드", "🎨 콘텐츠 템플릿", "📊 업계 데이터"])
    
    with tab1:
        st.markdown("### 🛠️ 인플루언서 필수 도구 및 앱")
        
        tools_categories = {
            "촬영 & 편집": [
                {"이름": "VSCO", "용도": "필터 및 사진 보정", "가격": "무료/프리미엄 월 19,900원", "추천도": "⭐⭐⭐⭐⭐"},
                {"이름": "CapCut", "용도": "릴스 동영상 편집", "가격": "무료", "추천도": "⭐⭐⭐⭐⭐"},
                {"이름": "Unfold", "용도": "스토리 템플릿", "가격": "무료/프리미엄", "추천도": "⭐⭐⭐⭐"},
                {"이름": "Lightroom", "용도": "전문 사진 편집", "가격": "월 12,000원", "추천도": "⭐⭐⭐⭐"},
            ],
            "기획 & 스케줄링": [
                {"이름": "Later", "용도": "포스트 예약 게시", "가격": "무료/월 $18", "추천도": "⭐⭐⭐⭐⭐"},
                {"이름": "Planoly", "용도": "피드 미리보기", "가격": "무료/월 $15", "추천도": "⭐⭐⭐⭐"},
                {"이름": "Notion", "용도": "콘텐츠 기획 및 관리", "가격": "무료/월 $8", "추천도": "⭐⭐⭐⭐"},
            ],
            "성과 분석": [
                {"이름": "Instagram Insights", "용도": "기본 분석 도구", "가격": "무료", "추천도": "⭐⭐⭐⭐"},
                {"이름": "Later Influence", "용도": "상세한 성과 분석", "가격": "월 $25", "추천도": "⭐⭐⭐⭐"},
                {"이름": "Social Blade", "용도": "경쟁자 분석", "가격": "무료/프리미엄", "추천도": "⭐⭐⭐"},
            ]
        }
        
        for category, tools in tools_categories.items():
            st.markdown(f"#### {category}")
            for tool in tools:
                col1, col2, col3, col4 = st.columns([2, 2, 1.5, 1])
                with col1:
                    st.markdown(f"**{tool['이름']}**")
                with col2:
                    st.markdown(tool['용도'])
                with col3:
                    st.markdown(tool['가격'])
                with col4:
                    st.markdown(tool['추천도'])
            st.markdown("---")
    
    with tab2:
        st.markdown("### 📖 인플루언서 성장 가이드")
        
        guides = [
            {
                "제목": "인플루언서 첫걸음: 0에서 1K까지",
                "설명": "팔로워 1,000명까지 성장하는 단계별 실전 가이드",
                "난이도": "초급",
                "소요시간": "20분"
            },
            {
                "제목": "릴스 마스터하기: 바이럴 공식", 
                "설명": "참여율 높은 릴스 콘텐츠 제작 노하우와 편집 팁",
                "난이도": "초급-중급",
                "소요시간": "25분"
            },
            {
                "제목": "브랜드 협찬 받는 법: 제안서부터 협상까지",
                "설명": "브랜드 파트너십 성사를 위한 완벽 가이드",
                "난이도": "중급",
                "소요시간": "35분"
            },
            {
                "제목": "개인 브랜드 수익화 전략",
                "설명": "인플루언서 수입원 다각화와 비즈니스 모델 구축",
                "난이도": "고급", 
                "소요시간": "40분"
            },
            {
                "제목": "해시태그 최적화 완벽 가이드",
                "설명": "도달률 극대화를 위한 해시태그 연구 및 활용법",
                "난이도": "중급",
                "소요시간": "15분"
            }
        ]
        
        for guide in guides:
            with st.expander(f"📖 {guide['제목']}"):
                st.markdown(f"**설명**: {guide['설명']}")
                st.markdown(f"**난이도**: {guide['난이도']} | **소요시간**: {guide['소요시간']}")
                
                # 가이드별 미리보기 내용
                if "첫걸음" in guide['제목']:
                    preview_content = """
                    **핵심 내용 미리보기:**
                    - 매력적인 프로필 설정법
                    - 첫 100명 팔로워 확보 전략  
                    - 콘텐츠 일관성 유지하기
                    - 해시태그 초보자 전략
                    """
                    full_content = generate_guide_content("첫걸음")
                elif "릴스" in guide['제목']:
                    preview_content = """
                    **핵심 내용 미리보기:**
                    - 트렌딩 오디오 활용법
                    - 15초 안에 시선 사로잡기
                    - 릴스 편집 꿀팁 5가지
                    - 알고리즘 친화적 업로드 시간
                    """
                    full_content = generate_guide_content("릴스")
                elif "협찬" in guide['제목']:
                    preview_content = """
                    **핵심 내용 미리보기:**
                    - 브랜드 어프로치 이메일 템플릿
                    - 협찬 단가 산정 방법
                    - 계약서 체크포인트
                    - 협찬 콘텐츠 제작 가이드라인
                    """
                    full_content = generate_guide_content("협찬")
                elif "수익화" in guide['제목']:
                    preview_content = """
                    **핵심 내용 미리보기:**
                    - 수익원 다각화 전략
                    - 개인 브랜드 상품 출시법
                    - 온라인 클래스 런칭 가이드
                    - 지속가능한 수익 모델 구축
                    """
                    full_content = generate_guide_content("수익화")
                elif "해시태그" in guide['제목']:
                    preview_content = """
                    **핵심 내용 미리보기:**
                    - 해시태그 조합 황금 비율
                    - 도달률 극대화 전략
                    - 틈새 해시태그 발굴법
                    - 시간대별 해시태그 활용
                    """
                    full_content = generate_guide_content("해시태그")
                else:
                    preview_content = "**가이드 내용 준비 중입니다.**"
                    full_content = "가이드 내용이 준비 중입니다."
                
                st.markdown(preview_content)
                
                # 전체 가이드 보기/숨기기 기능
                if st.button(f"📚 전체 가이드 읽기", key=f"read_guide_{guide['제목']}"):
                    st.session_state[f"show_guide_{guide['제목']}"] = not st.session_state.get(f"show_guide_{guide['제목']}", False)
                
                # 전체 가이드 내용 표시
                if st.session_state.get(f"show_guide_{guide['제목']}", False):
                    st.markdown("---")
                    st.markdown(full_content)
                    
                    # 가이드 다운로드 버튼
                    st.download_button(
                        label="📥 가이드 PDF로 저장",
                        data=full_content,
                        file_name=f"{guide['제목'].replace(' ', '_').replace(':', '')}_guide.txt",
                        mime="text/plain",
                        key=f"download_guide_{guide['제목']}"
                    )
    
    with tab3:
        st.markdown("### 🎨 인플루언서 콘텐츠 템플릿")
        
        template_categories = {
            "릴스 템플릿": [
                {"name": "Get Ready With Me (GRWM)", "desc": "아침 루틴부터 완성된 룩까지"},
                {"name": "Day in My Life (DIML)", "desc": "하루 일상을 매력적으로 담는 법"}, 
                {"name": "Before & After 변화", "desc": "변화 과정을 드라마틱하게 표현"},
                {"name": "튜토리얼 & 팁 공유", "desc": "노하우를 쉽게 전달하는 구성"},
                {"name": "Q&A 릴스 포맷", "desc": "팔로워 질문에 재미있게 답하기"}
            ],
            "스토리 템플릿": [
                {"name": "This or That 질문", "desc": "선택지를 제시하여 참여 유도"},
                {"name": "팔로워 투표 시리즈", "desc": "투표 기능으로 소통하기"},
                {"name": "Behind the Scenes", "desc": "일상의 뒷이야기 공유"},
                {"name": "Product Review 하이라이트", "desc": "제품 리뷰를 하이라이트로"},
                {"name": "일일 루틴 공유", "desc": "루틴을 스토리로 기록하기"}
            ],
            "캐러셀 아이디어": [
                {"name": "일주일 룩북", "desc": "한 주간의 스타일링 모음집"},
                {"name": "Top 5 추천 리스트", "desc": "추천 아이템을 정리한 리스트"}, 
                {"name": "Before & After 과정", "desc": "변화 과정을 단계별로 보여주기"},
                {"name": "스타일링 팁 모음", "desc": "유용한 팁들을 한눈에"},
                {"name": "월별 즐겨찾기", "desc": "이달의 최애 아이템 소개"}
            ],
            "협찬 콘텐츠": [
                {"name": "자연스러운 제품 소개", "desc": "일상에 자연스럽게 녹인 협찬"},
                {"name": "사용 후기 & 리뷰", "desc": "솔직한 후기로 신뢰도 높이기"},
                {"name": "제품 비교 분석", "desc": "객관적 비교로 전문성 어필"},
                {"name": "라이프스타일 연출", "desc": "제품과 함께하는 라이프스타일"},
                {"name": "Unboxing & 첫인상", "desc": "개봉기와 첫 사용 경험"}
            ]
        }
        
        for category, templates in template_categories.items():
            st.markdown(f"#### {category}")
            
            for i, template in enumerate(templates):
                col1, col2, col3 = st.columns([3, 4, 2])
                
                with col1:
                    st.markdown(f"**📱 {template['name']}**")
                
                with col2:
                    st.markdown(f"*{template['desc']}*")
                
                with col3:
                    # 실제 다운로드 가능한 템플릿 생성
                    template_content = generate_template_content(template['name'], category)
                    
                    st.download_button(
                        label="📥 다운로드",
                        data=template_content,
                        file_name=f"{template['name'].replace(' ', '_').replace('&', 'and')}_template.txt",
                        mime="text/plain",
                        key=f"download_{category}_{i}"
                    )
            st.markdown("---")
        
        # 추가: 모든 템플릿 한번에 다운로드
        st.markdown("### 📦 전체 템플릿 패키지")
        
        all_templates = generate_all_templates_package()
        st.download_button(
            label="🎁 모든 템플릿 한번에 다운로드",
            data=all_templates,
            file_name="influencer_templates_complete_package.txt",
            mime="text/plain",
            key="download_all_templates"
        )
    
    with tab4:
        st.markdown("### 📊 인플루언서 업계 데이터 및 벤치마크")
        
        # 팔로워 단계별 벤치마크 데이터
        benchmark_data = {
            "팔로워_구간": ["1K-10K", "10K-50K", "50K-100K", "100K-500K", "500K+"],
            "평균_참여율": [4.2, 3.8, 3.1, 2.4, 1.8],
            "월평균_협찬": [0.5, 2.3, 5.8, 12.5, 25.0],
            "평균_협찬료": [10, 50, 150, 500, 2000]  # 만원 단위
        }
        
        col1, col2 = st.columns(2)
        
        with col1:
            if PLOTLY_AVAILABLE:
                fig = px.bar(
                    x=benchmark_data["팔로워_구간"],
                    y=benchmark_data["평균_참여율"],
                def generate_template_content(template_name: str, category: str) -> str:
    """개별 템플릿 콘텐츠 생성"""
    
    base_header = f"""
🎨 {template_name} 템플릿
카테고리: {category}
생성일: {datetime.now().strftime('%Y-%m-%d')}

{'='*50}
📋 템플릿 개요
{'='*50}
"""
    
    if "GRWM" in template_name:
        content = base_header + """
💄 Get Ready With Me (GRWM) 템플릿

🎯 목적: 아침/저녁 루틴을 매력적으로 보여주어 팔로워와 친밀감 형성

📝 구성 단계:
1. 오프닝 (3초): "안녕 여러분! 오늘 GRWM 시작할게요"
2. 스킨케어 (10-15초): 단계별 제품 사용 모습
3. 베이스 메이크업 (10-15초): 파운데이션, 컨실러 등
4. 포인트 메이크업 (15-20초): 아이섀도, 립 등
5. 헤어스타일링 (10초): 간단한 헤어 연출
6. 완성된 모습 (5초): 최종 룩 공개
7. 엔딩 (2초): "오늘 룩 어떠세요? 댓글로 알려주세요!"

💡 촬영 팁:
- 자연광이 들어오는 곳에서 촬영
- 거울 앞에서 45도 각도로 촬영
- 제품 사용하는 모습을 클로즈업으로
- 트렌딩 음악 사용 (저작권 주의)

📸 필수 샷:
□ 민낯 → 완성 룩 비교
□ 제품들 플랫레이
□ 사용 과정 타임랩스
□ 완성된 룩 정면/측면

🏷️ 추천 해시태그:
#GRWM #GetReadyWithMe #morningroutine #makeup #dailylook #뷰티 #메이크업 #일상 #루틴 #셀프메이크업

💬 캡션 예시:
"오늘의 GRWM✨ 
요즘 즐겨 쓰는 제품들로 
내추럴한 데일리 메이크업 완성!
어떤 단계가 가장 궁금하세요?
댓글로 알려주시면 자세히 알려드릴게요💕

#GRWM #데일리메이크업"
"""

    elif "DIML" in template_name:
        content = base_header + """
🌅 Day in My Life (DIML) 템플릿

🎯 목적: 일상을 매력적으로 보여주어 팔로워들과 라이프스타일 공유

📝 구성 단계:
1. 굿모닝 (3초): 침실에서 일어나는 모습
2. 모닝루틴 (10초): 세안, 스킨케어, 옷 입기
3. 아침식사 (5초): 건강한 아침 메뉴
4. 일과 시작 (10초): 출근/공부/운동 등
5. 점심시간 (5초): 맛있는 점심 메뉴
6. 오후 활동 (10초): 주요 활동들
7. 저녁 루틴 (10초): 저녁식사, 휴식
8. 나이트 루틴 (7초): 세안, 스킨케어, 잠자리 준비

💡 촬영 팁:
- 하루 종일 틈틈이 촬영
- 각 장면마다 다른 앵글 사용
- 타임랩스와 일반 속도 조합
- 감성적인 음악 선택

📸 필수 샷:
□ 침실 → 화장실 → 부엌 → 외출
□ 음식/음료 클로즈업
□ 거울 셀카
□ 발걸음, 손동작 디테일

🏷️ 추천 해시태그:
#DIML #DayInMyLife #daily #lifestyle #routine #vlog #일상 #라이프 #데일리 #브이로그

💬 캡션 예시:
"평범하지만 소중한 하루🌸
요즘 루틴이 많이 바뀌었는데
어떤 부분이 가장 궁금하신가요?
댓글로 질문해주세요!

#DIML #일상브이로그"
"""

    elif "Before & After" in template_name:
        content = base_header + """
✨ Before & After 변화 템플릿

🎯 목적: 변화 과정을 드라마틱하게 보여주어 높은 참여율과 저장률 달성

📝 구성 단계:
1. Before 공개 (3초): 변화 전 모습
2. 과정 예고 (2초): "지금부터 변신 시작!"
3. 변화 과정 (15초): 단계별 변화 과정
4. After 공개 (3초): 변화 후 모습
5. 비교 장면 (2초): Before/After 나란히

💡 적용 분야:
- 메이크업 변신 (민낯 → 완성)
- 헤어스타일 변화 (기본 → 스타일링)
- 방 정리 (어수선함 → 깔끔함)
- 옷 스타일링 (기본 → 완성)
- 운동 효과 (Before → After)

📸 촬영 팁:
- 같은 각도, 같은 조명에서 촬영
- Before는 의도적으로 평범하게
- 과정은 타임랩스 활용
- After는 여러 각도로 보여주기

🏷️ 추천 해시태그:
#BeforeAndAfter #transformation #glow up #makeover #변신 #변화 #뷰티 #스타일링

💬 캡션 예시:
"놀라운 변화🤩
이렇게 달라질 줄 몰랐는데...
어느 부분 변화가 가장 놀라우셨나요?
댓글로 알려주세요!

#변신 #BeforeAndAfter"
"""

    elif "튜토리얼" in template_name:
        content = base_header + """
📚 튜토리얼 & 팁 공유 템플릿

🎯 목적: 유용한 정보를 쉽게 전달하여 전문성 어필 및 저장률 증대

📝 구성 단계:
1. 문제 제기 (3초): "이런 고민 있으시죠?"
2. 해결책 소개 (2초): "오늘 알려드릴 팁은..."
3. 단계별 설명 (20초): 3-5단계로 나누어 설명
4. 결과 확인 (3초): 완성된 모습
5. 핵심 포인트 (2초): "포인트는 바로 이것!"

💡 인기 주제:
- 메이크업 기법 (아이라인, 컨투어링 등)
- 스타일링 팁 (옷 매칭, 액세서리 활용)
- 사진 잘 찍는 법 (포즈, 각도)
- 생활 꿀팁 (정리, 요리 등)
- 셀프케어 방법

📸 촬영 팁:
- 각 단계마다 명확한 구분
- 중요한 부분은 슬로우모션
- 텍스트 오버레이로 설명 추가
- 손동작을 크고 명확하게

🏷️ 추천 해시태그:
#tutorial #tips #howto #꿀팁 #튜토리얼 #팁 #노하우 #방법 #가이드

💬 캡션 예시:
"모르면 손해인 꿀팁💡
정말 간단한데 효과는 확실해요!
여러분도 따라해보시고 
결과 사진 태그해주세요✨

#꿀팁 #tutorial"
"""

    else:
        # 기본 템플릿
        content = base_header + f"""
🎬 {template_name} 가이드

📋 기본 구성:
1. 오프닝 (2-3초): 시선을 끄는 첫 장면
2. 메인 콘텐츠 (15-20초): 핵심 내용 전달
3. 클로징 (2-3초): 마무리 및 CTA

💡 촬영 팁:
- 첫 3초가 가장 중요
- 음악과 영상의 싱크 맞추기
- 자연스러운 전환 효과 사용
- 적절한 텍스트 오버레이 활용

📸 권장 샷:
□ 클로즈업
□ 풀샷
□ 디테일 샷
□ 앵글 변화

🏷️ 기본 해시태그:
#{template_name.lower().replace(' ', '')} #인플루언서 #콘텐츠 #팁

💬 캡션 작성 팁:
- 개인적인 경험담 포함
- 질문으로 참여 유도
- 이모지 적절히 활용
- 해시태그는 10개 내외
"""

    return content

def generate_all_templates_package() -> str:
    """모든 템플릿을 포함한 완전한 패키지 생성"""
    
    package = f"""
🎁 인플루언서 콘텐츠 템플릿 완전 패키지
생성일: {datetime.now().strftime('%Y-%m-%d')}

{'='*60}
📋 패키지 구성
{'='*60}

이 패키지에는 다음 템플릿들이 포함되어 있습니다:

📱 릴스 템플릿 (5개)
🎬 스토리 템플릿 (5개)  
📸 캐러셀 아이디어 (5개)
💼 협찬 콘텐츠 (5개)

총 20개의 검증된 템플릿으로 구성되어 있습니다.

{'='*60}
🎯 사용 가이드
{'='*60}

1. 자신의 브랜드에 맞는 템플릿 선택
2. 템플릿을 참고하여 콘텐츠 기획
3. 개인만의 색깔 추가하여 차별화
4. 지속적으로 실험하고 개선

{'='*60}
📈 성공 공식
{'='*60}

✨ 일관성: 정기적인 업로드
🎯 타겟팅: 명확한 타겟 오디언스
💡 창의성: 독창적인 아이디어
📊 분석: 데이터 기반 개선
🤝 소통: 팔로워와의 적극적 상호작용

{'='*60}
🛠️ 추천 도구
{'='*60}

촬영: 스마트폰 + 삼각대
편집: CapCut, VSCO, Unfold
기획: Notion, 캘린더 앱
분석: Instagram Insights

{'='*60}
💡 월별 콘텐츠 아이디어
{'='*60}

1월: 새해 목표, 일상 루틴
2월: 겨울 패션, 발렌타인
3월: 봄 준비, 새학기
4월: 봄 나들이, 패션
5월: 야외 활동, 여행
6월: 여름 준비, 다이어트
7월: 휴가, 여름 스타일
8월: 바캉스, 여름 뷰티
9월: 가을 준비, 패션
10월: 가을 분위기, 할로윈
11월: 겨울 준비, 감성
12월: 연말, 크리스마스

{'='*60}
🎨 개별 템플릿 상세 가이드
{'='*60}

"""
    
    # 각 템플릿의 상세 내용 추가
    templates = [
        ("Get Ready With Me (GRWM)", "릴스 템플릿"),
        ("Day in My Life (DIML)", "릴스 템플릿"),
        ("Before & After 변화", "릴스 템플릿"),
        ("튜토리얼 & 팁 공유", "릴스 템플릿"),
        ("This or That 질문", "스토리 템플릿"),
        ("자연스러운 제품 소개", "협찬 콘텐츠")
    ]
    
    for template_name, category in templates:
        package += f"\n{'-'*40}\n"
        package += generate_template_content(template_name, category)
        package += f"\n{'-'*40}\n"
    
    package += f"""

{'='*60}
🚀 성공하는 인플루언서가 되는 법
{'='*60}

1. 진정성 유지: 가짜보다는 진짜 모습을
2. 꾸준함: 작은 것이라도 매일 꾸준히
3. 소통: 팔로워와의 진정한 관계 구축
4. 학습: 트렌드와 알고리즘 변화 파악
5. 실험: 새로운 콘텐츠 형식 시도
6. 분석: 데이터를 통한 지속적 개선
7. 네트워킹: 동료 크리에이터들과 교류

{'='*60}
📞 추가 지원
{'='*60}

이 템플릿들은 Instagram Influencer Expert에서 제공됩니다.
더 상세한 가이드가 필요하시면 언제든 새로운 분석을 받아보세요!

인플루언서로서의 성공적인 여정을 응원합니다! ✨

생성 시간: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
"""
    
    return package
    """인플루언서 가이드 문서 생성"""
    guide = f"""
✨ 개인 인플루언서 성장 가이드
생성일: {datetime.now().strftime('%Y-%m-%d')}
인플루언서 ID: {profile.id[:8]}

{'='*50}
🌟 인플루언서 전략 개요
{'='*50}

인플루언서 타입: {strategy.brand_type}
성장 전략: {strategy.strategy_name}
현재 단계: {SURVEY_DATA['business_stages'][profile.business_stage]}
전문 분야: {SURVEY_DATA['business_types'][profile.business_type]}

{'='*50}
👥 타겟 팔로워 분석
{'='*50}

주요 연령대: {SURVEY_DATA['age_groups'][profile.target_age_group]}
성별 분포: {profile.target_gender}
성장 목표: {', '.join([SURVEY_DATA['primary_goals'][goal] for goal in profile.primary_goals])}

{'='*50}
🎨 개인 브랜드 아이덴티티
{'='*50}

개성 유형: {SURVEY_DATA['brand_archetypes'][profile.brand_archetype]}

콘텐츠 스타일:
- 포멀(1) ←→ 캐주얼(10): {profile.tone_scores['formal_casual']}/10
- 진지함(1) ←→ 재미있음(10): {profile.tone_scores['serious_fun']}/10  
- 예의바름(1) ←→ 솔직함(10): {profile.tone_scores['polite_bold']}/10
- 정보전달(1) ←→ 감정표현(10): {profile.tone_scores['factual_passionate']}/10

{'='*50}
📋 콘텐츠 전략
{'='*50}

콘텐츠 필러:
{chr(10).join([f"{i+1}. {pillar}" for i, pillar in enumerate(strategy.content_pillars)])}

콘텐츠 구성 비율:
{chr(10).join([f"- {format}: {ratio}%" for format, ratio in strategy.content_mix.items()])}

주간 게시 빈도:
{chr(10).join([f"- {format}: {freq}개" for format, freq in strategy.posting_frequency.items()])}

{'='*50}
🎯 성장 목표 (KPI)
{'='*50}

{chr(10).join([f"- {kpi.replace('_', ' ').title()}: {target}%" for kpi, target in strategy.kpi_targets.items()])}

{'='*50}
🛠️ 추천 도구 및 앱
{'='*50}

{chr(10).join([f"- {tool}" for tool in strategy.recommended_tools])}

{'='*50}
💼 현재 리소스 현황
{'='*50}

가용 시간: {profile.time_available}
월간 예산: {profile.budget}
보유 장비: {', '.join(profile.tools_available) if profile.tools_available else '기본 스마트폰'}

{'='*50}
🏆 벤치마킹 인플루언서
{'='*50}

롤모델 계정: {', '.join(profile.competitors) if profile.competitors else '미지정'}
나만의 차별점: {', '.join(profile.differentiation) if profile.differentiation else '미지정'}

{'='*50}
📅 4주간 집중 실행 계획
{'='*50}

{chr(10).join([f"""
Week {plan['week']}: {plan['phase']}
핵심 목표: {plan['kpi_focus']}
실행 과제:
{chr(10).join([f"  ✓ {task}" for task in plan['tasks']])}
""" for plan in strategy.weekly_plans[:4]])}

{'='*50}
💡 인플루언서 성공 비밀 팁
{'='*50}

1. 진정성 유지: 완벽한 모습보다 진실한 이야기가 더 큰 공감을 만듭니다.

2. 꾸준함이 핵심: 하루에 몰아서 하는 것보다 매일 조금씩이 더 효과적입니다.

3. 팔로워와 소통: 댓글, DM에 성심껏 답변하며 진짜 관계를 만들어가세요.

4. 트렌드 활용: 새로운 기능과 트렌딩 해시태그를 빠르게 시도해보세요.

5. 자신만의 색깔: 다른 사람을 따라하기보다 나만의 독특함을 강조하세요.

6. 데이터 체크: 주간 인사이트를 확인하고 무엇이 잘 되는지 파악하세요.

7. 네트워킹: 같은 분야 인플루언서들과 건전한 교류를 유지하세요.

{'='*50}
🚀 수익화 로드맵
{'='*50}

1단계 (팔로워 1K): 
- 개인 브랜드 확립
- 콘텐츠 퀄리티 향상
- 팔로워와의 신뢰 구축

2단계 (팔로워 5K):
- 소규모 브랜드 협찬 시작
- 개인 제품/서비스 테스트
- 다른 크리에이터와 협업

3단계 (팔로워 10K+):
- 정기적인 브랜드 파트너십
- 온라인 클래스/컨설팅 런칭
- 개인 브랜드 상품 출시

{'='*50}
📞 지원 및 추가 도움
{'='*50}

이 가이드는 Instagram Influencer Expert 시스템에서 생성되었습니다.
인플루언서 여정에서 어려움이 있다면 언제든 새로운 분석을 실행하세요.

당신의 성공적인 인플루언서 여정을 응원합니다! ✨

생성 시간: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
"""
    return guideimport streamlit as st
import pandas as pd
from datetime import datetime, timedelta
from dataclasses import dataclass, asdict
from typing import Dict, List, Optional
import uuid

# Plotly import with fallback
try:
    import plotly.express as px
    import plotly.graph_objects as go
    PLOTLY_AVAILABLE = True
except ImportError:
    PLOTLY_AVAILABLE = False
    # 개발 환경에서만 경고 표시
    if st.secrets.get("environment", "production") == "development":
        st.warning("Plotly is not available. Using Streamlit native charts.")

# 페이지 설정
st.set_page_config(
    page_title="Instagram Influencer Expert",
    page_icon="✨",
    layout="wide",
    initial_sidebar_state="expanded"
)

# CSS 스타일링
st.markdown("""
<style>
    .main-header {
        background: linear-gradient(90deg, #833AB4, #FD1D1D, #FCB045);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-size: 3rem;
        font-weight: bold;
        text-align: center;
        margin-bottom: 2rem;
    }
    
    .section-header {
        background: linear-gradient(45deg, #833AB4, #FD1D1D);
        color: white;
        padding: 1rem;
        border-radius: 10px;
        margin: 1rem 0;
    }
    
    .metric-card {
        background: white;
        padding: 1rem;
        border-radius: 10px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        border-left: 4px solid #833AB4;
    }
    
    .progress-bar {
        background: linear-gradient(90deg, #833AB4, #FD1D1D);
        height: 10px;
        border-radius: 5px;
    }
    
    .survey-question {
        background: #f8f9fa;
        padding: 1.5rem;
        border-radius: 10px;
        margin: 1rem 0;
        border-left: 4px solid #FCB045;
    }
</style>
""", unsafe_allow_html=True)

# 데이터 클래스 정의
@dataclass
class UserProfile:
    id: str
    business_stage: str
    business_type: str
    instagram_status: str
    target_age_group: str
    target_gender: str
    primary_goals: List[str]
    brand_archetype: str
    tone_scores: Dict[str, int]
    competitors: List[str]
    differentiation: List[str]
    time_available: str
    budget: str
    tools_available: List[str]
    created_at: str

@dataclass
class BrandStrategy:
    brand_type: str
    strategy_name: str
    content_pillars: List[str]
    posting_frequency: Dict[str, int]
    content_mix: Dict[str, int]
    recommended_tools: List[str]
    kpi_targets: Dict[str, float]
    weekly_plans: List[Dict]

# 설문 데이터 정의
SURVEY_DATA = {
    "business_stages": {
        "beginner": "인플루언서 입문 단계 (팔로워 100명 미만)",
        "micro": "마이크로 인플루언서 (팔로워 100-10K)", 
        "mid": "미드 티어 인플루언서 (팔로워 10K-100K)",
        "macro": "매크로 인플루언서 (팔로워 100K 이상)"
    },
    
    "business_types": {
        "lifestyle": "라이프스타일 인플루언서",
        "beauty": "뷰티/패션 인플루언서",
        "fitness": "피트니스/건강 인플루언서",
        "food": "푸드/요리 인플루언서",
        "travel": "여행 인플루언서",
        "tech": "테크/리뷰 인플루언서",
        "education": "교육/지식 공유 인플루언서",
        "entertainment": "엔터테인먼트/유머 인플루언서"
    },
    
    "instagram_statuses": {
        "none": "아직 계정이 없음",
        "personal": "개인 계정 보유",
        "business_small": "비즈니스 계정 (팔로워 100명 미만)",
        "business_medium": "비즈니스 계정 (팔로워 100-1000명)",
        "business_large": "비즈니스 계정 (팔로워 1000명 이상)"
    },
    
    "age_groups": {
        "18-24": "18-24세 (Gen Z)",
        "25-34": "25-34세 (젊은 밀레니얼)",
        "35-44": "35-44세 (기성 밀레니얼)",
        "45-54": "45-54세 (Gen X)",
        "55+": "55세 이상"
    },
    
    "primary_goals": {
        "followers": "팔로워 수 증가",
        "engagement": "참여율 및 커뮤니티 활성화",
        "brand_deals": "브랜드 협찬 및 제휴 기회",
        "personal_brand": "개인 브랜드 가치 상승",
        "monetization": "수익 창출 (제품 판매, 클래스 등)",
        "influence": "특정 분야에서의 영향력 확대",
        "networking": "업계 네트워킹 및 관계 구축"
    },
    
    "brand_archetypes": {
        "innocent": "The Innocent (순수함, 정직함)",
        "sage": "The Sage (지혜로움, 전문성)",
        "explorer": "The Explorer (모험적, 혁신적)",
        "outlaw": "The Outlaw (반항적, 혁명적)",
        "magician": "The Magician (변화 창조, 혁신)",
        "hero": "The Hero (용기있는, 결단력)",
        "lover": "The Lover (열정적, 로맨틱)",
        "jester": "The Jester (재미있는, 유머러스)",
        "everyman": "The Everyman (친근한, 접근 가능한)",
        "caregiver": "The Caregiver (보살피는, 돌보는)",
        "ruler": "The Ruler (권위적, 리더십)",
        "creator": "The Creator (창의적, 예술적)"
    }
}

# 전략 매칭 엔진
class StrategyEngine:
    def __init__(self):
        self.strategies = {
            "lifestyle_followers": {
                "brand_type": "라이프스타일 인플루언서",
                "strategy_name": "일상 공유형 팔로워 확장 전략",
                "content_pillars": ["일상 브이로그", "팔로워 Q&A", "루틴 공유", "솔직한 후기", "팔로워와 소통"],
                "posting_frequency": {"총_게시물": 14, "릴스": 10, "캐러셀": 3, "스토리": 20},
                "content_mix": {"릴스": 70, "캐러셀": 20, "스토리": 10},
                "recommended_tools": ["인스타그램 릴스", "VSCO 필터", "인스타 스토리 기능"],
                "kpi_targets": {"팔로워_증가율": 25.0, "참여율": 2.5, "스토리_완료율": 70.0}
            },
            "beauty_brand_deals": {
                "brand_type": "뷰티 인플루언서", 
                "strategy_name": "브랜드 협찬 중심 전문성 구축 전략",
                "content_pillars": ["제품 리뷰", "메이크업 튜토리얼", "스킨케어 루틴", "제품 비교", "뷰티 팁"],
                "posting_frequency": {"총_게시물": 12, "릴스": 8, "캐러셀": 3, "싱글포스트": 1},
                "content_mix": {"릴스": 65, "캐러셀": 25, "싱글포스트": 10},
                "recommended_tools": ["좋은 조명", "메이크업 도구", "제품 촬영 세팅"],
                "kpi_targets": {"팔로워_증가율": 20.0, "참여율": 3.0, "브랜드_협찬": 2.0}
            },
            "fitness_community": {
                "brand_type": "피트니스 인플루언서",
                "strategy_name": "커뮤니티 기반 동기부여 전략", 
                "content_pillars": ["운동 루틴", "식단 공유", "변화 과정", "동기부여", "팔로워 챌린지"],
                "posting_frequency": {"총_게시물": 16, "릴스": 12, "캐러셀": 3, "스토리": 25},
                "content_mix": {"릴스": 75, "캐러셀": 15, "스토리": 10},
                "recommended_tools": ["운동복 컬렉션", "타이머", "음식 촬영"],
                "kpi_targets": {"팔로워_증가율": 30.0, "참여율": 4.0, "커뮤니티_활동": 50.0}
            },
            "food_monetization": {
                "brand_type": "푸드 인플루언서",
                "strategy_name": "레시피 콘텐츠 수익화 전략",
                "content_pillars": ["레시피 영상", "맛집 탐방", "요리 과정", "음식 스타일링", "쿠킹 클래스"],
                "posting_frequency": {"총_게시물": 10, "릴스": 7, "캐러셀": 2, "라이브": 1},
                "content_mix": {"릴스": 70, "캐러셀": 20, "라이브": 10},
                "recommended_tools": ["음식 촬영 장비", "편집 앱", "요리 도구"],
                "kpi_targets": {"팔로워_증가율": 18.0, "참여율": 2.8, "수익화": 15.0}
            }
        }
    
    def match_strategy(self, profile: UserProfile) -> BrandStrategy:
        # 인플루언서 타입과 주요 목표를 기반으로 전략 매칭
        key = f"{profile.business_type}_{profile.primary_goals[0] if profile.primary_goals else 'followers'}"
        
        if key in self.strategies:
            strategy_data = self.strategies[key]
        else:
            # 기본 전략 - 라이프스타일 인플루언서
            strategy_data = self.strategies["lifestyle_followers"]
        
        # 주간 계획 생성
        weekly_plans = self.generate_weekly_plans(profile, strategy_data)
        
        return BrandStrategy(
            brand_type=strategy_data["brand_type"],
            strategy_name=strategy_data["strategy_name"],
            content_pillars=strategy_data["content_pillars"],
            posting_frequency=strategy_data["posting_frequency"],
            content_mix=strategy_data["content_mix"],
            recommended_tools=strategy_data["recommended_tools"],
            kpi_targets=strategy_data["kpi_targets"],
            weekly_plans=weekly_plans
        )
    
    def generate_weekly_plans(self, profile: UserProfile, strategy_data: Dict) -> List[Dict]:
        plans = []
        for week in range(1, 13):  # 12주 계획
            if week <= 2:
                phase = "개인 브랜드 기초 설정"
                tasks = [
                    "인스타그램 프로필 최적화 (바이오, 프로필 사진)",
                    "나만의 콘텐츠 스타일 및 톤 정하기",
                    "벤치마킹 인플루언서 분석하기",
                    "첫 2주치 콘텐츠 아이디어 리스트 만들기"
                ]
            elif week <= 6:
                phase = "콘텐츠 제작 및 일관성 구축"
                tasks = [
                    f"주간 {strategy_data['posting_frequency']['총_게시물']}개 포스트 꾸준히 올리기",
                    "스토리로 일상 공유하며 친밀감 형성",
                    "팔로워 댓글에 24시간 내 답변하기",
                    "해시태그 연구하고 적절히 활용하기"
                ]
            elif week <= 10:
                phase = "팔로워 확장 및 참여도 증대"
                tasks = [
                    "다른 인플루언서와 상호 멘션 및 협업",
                    "트렌딩 주제로 릴스 콘텐츠 제작",
                    "팔로워들과 Q&A나 라이브 진행",
                    "UGC 유도 이벤트나 챌린지 기획"
                ]
            else:
                phase = "수익화 및 브랜드 구축"
                tasks = [
                    "브랜드 협찬 제안서 준비 및 발송",
                    "개인 제품/서비스 런칭 준비",
                    "팔로워 세분화 및 타겟팅 정교화",
                    "장기적 브랜드 비전 수립"
                ]
            
            plans.append({
                "week": week,
                "phase": phase,
                "tasks": tasks,
                "kpi_focus": list(strategy_data["kpi_targets"].keys())[0] if strategy_data["kpi_targets"] else "팔로워 증가"
            })
        
        return plans

# 세션 상태 초기화
if 'survey_completed' not in st.session_state:
    st.session_state.survey_completed = False
if 'user_profile' not in st.session_state:
    st.session_state.user_profile = None
if 'strategy' not in st.session_state:
    st.session_state.strategy = None
if 'show_survey' not in st.session_state:
    st.session_state.show_survey = False

# 메인 앱
def main():
    st.markdown('<h1 class="main-header">✨ Instagram Influencer Expert</h1>', unsafe_allow_html=True)
    st.markdown("### 🌟 개인 인플루언서를 꿈꾸는 당신을 위한 완벽한 성장 가이드")
    
    # 사이드바 네비게이션
    st.sidebar.title("📋 Navigation")
    
    # 버튼으로 설문조사 페이지 이동이 요청된 경우
    if st.session_state.get('show_survey', False):
        page = "📝 브랜딩 설문조사"
        st.session_state.show_survey = False  # 플래그 리셋
    else:
        page = st.sidebar.selectbox(
            "페이지 선택",
            ["🏠 홈", "📝 인플루언서 진단", "📊 성장 전략", "📈 성과 대시보드", "📚 리소스"]
        )
    
    if page == "🏠 홈":
        show_home()
    elif page == "📝 브랜딩 설문조사":
        show_survey()
    elif page == "📊 결과 및 전략":
        show_results()
    elif page == "📈 성과 대시보드":
        show_dashboard()
    elif page == "📚 리소스":
        show_resources()

def show_home():
    col1, col2 = st.columns([2, 1])
    
    with col1:
        st.markdown("""
        ## 🌟 2024-2025년 개인 인플루언서의 새로운 기회
        
        **개인 브랜드 구축의 황금기**
        - 📹 **숏폼 콘텐츠 폭발**: 릴스로 하루 만에 바이럴 가능
        - 🤝 **진정성이 트렌드**: 완벽함보다 진실한 스토리가 승부
        - 💰 **다양한 수익화**: 협찬, 제품 판매, 온라인 클래스까지
        
        **체계적인 성장 로드맵**
        1. **🎯 개성 발견**: 나만의 독특한 매력과 전문성 찾기
        2. **📈 팔로워 확보**: 유기적 성장 전략으로 진짜 팬 만들기
        3. **💡 수익화**: 개인 브랜드를 실제 수입으로 전환하기
        """)
        
        if st.button("✨ 인플루언서 성장 진단 시작", key="start_survey", type="primary"):
            # 세션 상태를 직접 변경하여 페이지 이동
            st.session_state.show_survey = True
            st.rerun()
    
    with col2:
        st.markdown("### 📊 인플루언서 시장 현황 (2024)")
        
        # 성과 지표 시각화 - 인플루언서 관련 데이터로 변경
        metrics_data = {
            "콘텐츠": ["릴스", "캐러셀", "스토리", "라이브"],
            "성장률": [85, 65, 45, 35]
        }
        
        if PLOTLY_AVAILABLE:
            fig = px.bar(
                x=metrics_data["콘텐츠"],
                y=metrics_data["성장률"],
                title="콘텐츠별 팔로워 성장률",
                color=metrics_data["성장률"],
                color_continuous_scale="Viridis"
            )
            fig.update_layout(height=300)
            st.plotly_chart(fig, use_container_width=True)
        else:
            st.markdown("#### 📊 콘텐츠별 팔로워 성장률")
            for content_type, rate in zip(metrics_data["콘텐츠"], metrics_data["성장률"]):
                st.metric(content_type, f"+{rate}%")
        
        st.info("💡 **인사이트**: 릴스 콘텐츠로 팔로워 성장률이 85% 높아집니다!")

def show_survey():
    st.markdown('<div class="section-header"><h2>📝 인플루언서 성장 진단</h2></div>', unsafe_allow_html=True)
    
    # 진행률 표시
    progress = st.progress(0)
    progress_text = st.empty()
    
    with st.form("influencer_survey"):
        # 섹션 1: 현재 상황
        st.markdown('<div class="survey-question">', unsafe_allow_html=True)
        st.markdown("### 🎯 섹션 1: 현재 인플루언서 상황")
        
        business_stage = st.selectbox(
            "현재 인플루언서 단계는?",
            options=list(SURVEY_DATA["business_stages"].keys()),
            format_func=lambda x: SURVEY_DATA["business_stages"][x],
            key="business_stage"
        )
        
        business_type = st.selectbox(
            "주요 콘텐츠 분야는?",
            options=list(SURVEY_DATA["business_types"].keys()),
            format_func=lambda x: SURVEY_DATA["business_types"][x],
            key="business_type"
        )
        
        instagram_status = st.selectbox(
            "인스타그램 계정 현재 상태는?",
            options=list(SURVEY_DATA["instagram_statuses"].keys()),
            format_func=lambda x: SURVEY_DATA["instagram_statuses"][x],
            key="instagram_status"
        )
        st.markdown('</div>', unsafe_allow_html=True)
        
        # 섹션 2: 목표 및 우선순위
        st.markdown('<div class="survey-question">', unsafe_allow_html=True)
        st.markdown("### 🌟 섹션 2: 인플루언서 목표")
        
        primary_goals = st.multiselect(
            "인플루언서로서 달성하고 싶은 주요 목표는? (우선순위별로 3개 선택)",
            options=list(SURVEY_DATA["primary_goals"].keys()),
            format_func=lambda x: SURVEY_DATA["primary_goals"][x],
            max_selections=3,
            key="primary_goals"
        )
        
        # 수익화 관련 질문 추가
        monetization_interest = st.radio(
            "수익화에 대한 관심 정도는?",
            ["아직 관심 없음 (성장 우선)", "관심 있지만 아직 준비 안됨", "적극적으로 수익화 원함"],
            key="monetization_interest"
        )
        st.markdown('</div>', unsafe_allow_html=True)
        
        # 섹션 3: 타겟 오디언스
        st.markdown('<div class="survey-question">', unsafe_allow_html=True)
        st.markdown("### 👥 섹션 3: 타겟 팔로워 분석")
        
        target_age_group = st.selectbox(
            "주요 타겟 팔로워의 연령대는?",
            options=list(SURVEY_DATA["age_groups"].keys()),
            format_func=lambda x: SURVEY_DATA["age_groups"][x],
            key="target_age_group"
        )
        
        target_gender = st.select_slider(
            "타겟 팔로워의 성별 분포는?",
            options=["주로 여성", "여성 중심", "균등 분포", "남성 중심", "주로 남성"],
            value="균등 분포",
            key="target_gender"
        )
        
        content_preference = st.multiselect(
            "팔로워들이 좋아할 만한 콘텐츠는? (3개 선택)",
            ["일상 브이로그", "전문 지식 공유", "제품 리뷰", "엔터테인먼트", 
             "뷰티/패션 팁", "운동/건강 정보", "여행 경험", "요리 레시피"],
            max_selections=3,
            key="content_preference"
        )
        st.markdown('</div>', unsafe_allow_html=True)
        
        # 섹션 4: 개성 및 브랜드
        st.markdown('<div class="survey-question">', unsafe_allow_html=True)
        st.markdown("### 🎨 섹션 4: 개인 브랜드 아이덴티티")
        
        brand_archetype = st.selectbox(
            "나의 개성과 가장 비슷한 유형은?",
            options=list(SURVEY_DATA["brand_archetypes"].keys()),
            format_func=lambda x: SURVEY_DATA["brand_archetypes"][x],
            key="brand_archetype"
        )
        
        # 개인 특성 슬라이더
        st.markdown("**나의 콘텐츠 스타일을 설정해주세요:**")
        
        col1, col2 = st.columns(2)
        with col1:
            formal_casual = st.slider("포멀 ↔ 캐주얼", 1, 10, 7, key="formal_casual")
            serious_fun = st.slider("진지함 ↔ 재미있음", 1, 10, 6, key="serious_fun")
        with col2:
            polite_bold = st.slider("예의바름 ↔ 솔직함", 1, 10, 6, key="polite_bold")
            factual_passionate = st.slider("정보 전달 ↔ 감정 표현", 1, 10, 7, key="factual_passionate")
        
        st.markdown('</div>', unsafe_allow_html=True)
        
        # 섹션 5: 경쟁자 분석
        st.markdown('<div class="survey-question">', unsafe_allow_html=True)
        st.markdown("### 🏆 섹션 5: 벤치마킹 인플루언서")
        
        competitors = []
        st.markdown("**롤모델로 삼는 인플루언서 계정을 알려주세요**")
        for i in range(3):
            competitor = st.text_input(f"벤치마킹 인플루언서 {i+1}의 계정명", 
                                     placeholder="@username", key=f"competitor_{i}")
            if competitor:
                competitors.append(competitor)
        
        differentiation = st.multiselect(
            "다른 인플루언서들과 비교해 나만의 차별점은?",
            ["독특한 개성과 유머", "전문적인 지식과 경험", "솔직하고 진정성 있는 스토리", 
             "뛰어난 비주얼과 센스", "꾸준함과 성실함", "창의적인 콘텐츠 아이디어",
             "팔로워와의 소통 능력", "특별한 라이프스타일"],
            key="differentiation"
        )
        st.markdown('</div>', unsafe_allow_html=True)
        
        # 섹션 6: 리소스 및 현실적 상황
        st.markdown('<div class="survey-question">', unsafe_allow_html=True)
        st.markdown("### 💼 섹션 6: 현실적 여건")
        
        time_available = st.selectbox(
            "주간 콘텐츠 제작에 투입 가능한 시간은?",
            ["2시간 미만 (부업으로)", "2-5시간 (취미 수준)", "5-10시간 (진지하게)", 
             "10-20시간 (주력 활동)", "20시간 이상 (전업 준비)"],
            key="time_available"
        )
        
        budget = st.selectbox(
            "월간 콘텐츠 제작 예산은? (의상, 소품, 도구 등)",
            ["예산 없음 (기존 것 활용)", "5만원 미만", "5-15만원", "15-30만원", "30만원 이상"],
            key="budget"
        )
        
        tools_available = st.multiselect(
            "현재 보유한 콘텐츠 제작 도구는?",
            ["스마트폰 (기본)", "조명 도구", "삼각대/짐벌", "편집 앱/소프트웨어", 
             "디자인 도구", "마이크/음향 장비"],
            key="tools_available"
        )
        st.markdown('</div>', unsafe_allow_html=True)
        
        # 제출 버튼
        submitted = st.form_submit_button("🌟 인플루언서 성장 전략 받기", type="primary")
        
        if submitted:
            # 필수 필드 검증
            if not all([business_stage, business_type, target_age_group, brand_archetype]):
                st.error("모든 필수 항목을 입력해주세요.")
                return
            
            # 사용자 프로필 생성
            user_profile = UserProfile(
                id=str(uuid.uuid4()),
                business_stage=business_stage,
                business_type=business_type,
                instagram_status=instagram_status,
                target_age_group=target_age_group,
                target_gender=target_gender,
                primary_goals=primary_goals,
                brand_archetype=brand_archetype,
                tone_scores={
                    "formal_casual": formal_casual,
                    "serious_fun": serious_fun,
                    "polite_bold": polite_bold,
                    "factual_passionate": factual_passionate
                },
                competitors=competitors,
                differentiation=differentiation,
                time_available=time_available,
                budget=budget,
                tools_available=tools_available,
                created_at=datetime.now().isoformat()
            )
            
            # 전략 생성
            engine = StrategyEngine()
            strategy = engine.match_strategy(user_profile)
            
            # 세션에 저장
            st.session_state.user_profile = user_profile
            st.session_state.strategy = strategy
            st.session_state.survey_completed = True
            
            st.success("🎉 개인 맞춤 인플루언서 전략이 완성되었습니다!")
            st.info("📊 '성장 전략' 페이지에서 상세한 가이드를 확인하세요.").selectbox(
            "브랜드가 속하는 아키타입은?",
            options=list(SURVEY_DATA["brand_archetypes"].keys()),
            format_func=lambda x: SURVEY_DATA["brand_archetypes"][x],
            key="brand_archetype"
        )
        
        # 브랜드 톤앤보이스 슬라이더
        st.markdown("**브랜드 톤앤보이스의 특성을 설정해주세요:**")
        
        col1, col2 = st.columns(2)
        with col1:
            formal_casual = st.slider("공식적 ↔ 캐주얼", 1, 10, 5, key="formal_casual")
            serious_fun = st.slider("진지함 ↔ 재미있음", 1, 10, 5, key="serious_fun")
        with col2:
            polite_bold = st.slider("정중함 ↔ 과감함", 1, 10, 5, key="polite_bold")
            factual_passionate = st.slider("사실적 ↔ 열정적", 1, 10, 5, key="factual_passionate")
        
        st.markdown('</div>', unsafe_allow_html=True)
        
        # 섹션 5: 경쟁사 분석
        st.markdown('<div class="survey-question">', unsafe_allow_html=True)
        st.markdown("### 🏆 섹션 5: 경쟁사 및 차별화")
        
        competitors = []
        for i in range(3):
            competitor = st.text_input(f"주요 경쟁사 {i+1}의 인스타그램 계정명", key=f"competitor_{i}")
            if competitor:
                competitors.append(competitor)
        
        differentiation = st.multiselect(
            "경쟁사 대비 차별화 포인트는?",
            ["더 나은 품질/성능", "더 저렴한 가격", "더 우수한 고객 서비스", 
             "더 혁신적인 기술/접근법", "더 강한 브랜드 스토리", "더 전문적인 expertise",
             "더 개인적인/친근한 접근", "더 지속가능한/윤리적 접근"],
            key="differentiation"
        )
        st.markdown('</div>', unsafe_allow_html=True)
        
        # 섹션 6: 리소스 평가
        st.markdown('<div class="survey-question">', unsafe_allow_html=True)
        st.markdown("### 💼 섹션 6: 리소스 및 실행 역량")
        
        time_available = st.selectbox(
            "주간 인스타그램 콘텐츠 제작에 투입 가능한 시간은?",
            ["2시간 미만", "2-5시간", "5-10시간", "10-20시간", "20시간 이상"],
            key="time_available"
        )
        
        budget = st.selectbox(
            "월간 인스타그램 마케팅 예산은?",
            ["예산 없음", "10만원 미만", "10-30만원", "30-50만원", "50-100만원", "100만원 이상"],
            key="budget"
        )
        
        tools_available = st.multiselect(
            "현재 보유한 콘텐츠 제작 도구는?",
            ["스마트폰 카메라", "전문 카메라", "조명 장비", "편집 소프트웨어", 
             "디자인 도구", "비디오 편집 도구"],
            key="tools_available"
        )
        st.markdown('</div>', unsafe_allow_html=True)
        
        # 제출 버튼
        submitted = st.form_submit_button("🎯 브랜딩 전략 생성하기", type="primary")
        
        if submitted:
            # 필수 필드 검증
            if not all([business_stage, business_type, target_age_group, brand_archetype]):
                st.error("모든 필수 항목을 입력해주세요.")
                return
            
            # 사용자 프로필 생성
            user_profile = UserProfile(
                id=str(uuid.uuid4()),
                business_stage=business_stage,
                business_type=business_type,
                instagram_status=instagram_status,
                target_age_group=target_age_group,
                target_gender=target_gender,
                primary_goals=primary_goals,
                brand_archetype=brand_archetype,
                tone_scores={
                    "formal_casual": formal_casual,
                    "serious_fun": serious_fun,
                    "polite_bold": polite_bold,
                    "factual_passionate": factual_passionate
                },
                competitors=competitors,
                differentiation=differentiation,
                time_available=time_available,
                budget=budget,
                tools_available=tools_available,
                created_at=datetime.now().isoformat()
            )
            
            # 전략 생성
            engine = StrategyEngine()
            strategy = engine.match_strategy(user_profile)
            
            # 세션에 저장
            st.session_state.user_profile = user_profile
            st.session_state.strategy = strategy
            st.session_state.survey_completed = True
            
            st.success("🎉 브랜딩 전략이 성공적으로 생성되었습니다!")
            st.info("📊 '결과 및 전략' 페이지에서 맞춤형 가이드를 확인하세요.")

def show_results():
    if not st.session_state.survey_completed:
        st.warning("먼저 인플루언서 진단을 완료해주세요.")
        return
    
    profile = st.session_state.user_profile
    strategy = st.session_state.strategy
    
    st.markdown('<div class="section-header"><h2>📊 맞춤형 인플루언서 성장 전략</h2></div>', unsafe_allow_html=True)
    
    # 인플루언서 타입 및 전략 개요
    col1, col2 = st.columns([2, 1])
    
    with col1:
        st.markdown(f"### 🌟 인플루언서 타입: **{strategy.brand_type}**")
        st.markdown(f"**성장 전략**: {strategy.strategy_name}")
        
        st.markdown("#### 📋 콘텐츠 필러 (5개)")
        for i, pillar in enumerate(strategy.content_pillars, 1):
            st.markdown(f"{i}. **{pillar}**")
    
    with col2:
        st.markdown("### 📊 콘텐츠 구성 비율")
        if PLOTLY_AVAILABLE:
            fig = px.pie(
                values=list(strategy.content_mix.values()),
                names=list(strategy.content_mix.keys()),
                title="권장 콘텐츠 구성"
            )
            fig.update_traces(textposition='inside', textinfo='percent+label')
            st.plotly_chart(fig, use_container_width=True)
        else:
            for content_type, percentage in strategy.content_mix.items():
                st.metric(content_type, f"{percentage}%")
    
    # KPI 목표 설정
    st.markdown("### 🎯 인플루언서 성장 목표 (KPI)")
    
    kpi_cols = st.columns(len(strategy.kpi_targets))
    for i, (kpi, target) in enumerate(strategy.kpi_targets.items()):
        with kpi_cols[i]:
            st.metric(
                label=kpi.replace("_", " ").title(),
                value=f"{target}{'%' if '율' in kpi else '개' if '협찬' in kpi else '%'}",
                delta="목표값"
            )
    
    # 주간 실행 계획
    st.markdown("### 📅 12주 인플루언서 성장 로드맵")
    
    # 단계별 탭
    tab1, tab2, tab3, tab4 = st.tabs(["🌱 기초 (1-2주)", "📈 성장 (3-6주)", "🚀 확장 (7-10주)", "💰 수익화 (11-12주)"])
    
    with tab1:
        foundation_weeks = [plan for plan in strategy.weekly_plans if plan["week"] <= 2]
        for week_plan in foundation_weeks:
            with st.expander(f"Week {week_plan['week']}: {week_plan['phase']}"):
                for task in week_plan['tasks']:
                    st.markdown(f"- [ ] {task}")
                st.markdown(f"**🎯 핵심 지표**: {week_plan['kpi_focus']}")
    
    with tab2:
        growth_weeks = [plan for plan in strategy.weekly_plans if 3 <= plan["week"] <= 6]
        for week_plan in growth_weeks:
            with st.expander(f"Week {week_plan['week']}: {week_plan['phase']}"):
                for task in week_plan['tasks']:
                    st.markdown(f"- [ ] {task}")
                st.markdown(f"**🎯 핵심 지표**: {week_plan['kpi_focus']}")
    
    with tab3:
        expansion_weeks = [plan for plan in strategy.weekly_plans if 7 <= plan["week"] <= 10]
        for week_plan in expansion_weeks:
            with st.expander(f"Week {week_plan['week']}: {week_plan['phase']}"):
                for task in week_plan['tasks']:
                    st.markdown(f"- [ ] {task}")
                st.markdown(f"**🎯 핵심 지표**: {week_plan['kpi_focus']}")
                
    with tab4:
        monetization_weeks = [plan for plan in strategy.weekly_plans if plan["week"] >= 11]
        for week_plan in monetization_weeks:
            with st.expander(f"Week {week_plan['week']}: {week_plan['phase']}"):
                for task in week_plan['tasks']:
                    st.markdown(f"- [ ] {task}")
                st.markdown(f"**🎯 핵심 지표**: {week_plan['kpi_focus']}")
    
    # 개인화된 팁
    st.markdown("### 💡 당신만의 맞춤 성장 팁")
    
    # 인플루언서 타입별 특별 조언
    if "lifestyle" in profile.business_type:
        st.info("🌟 **라이프스타일 인플루언서 특별 팁**: 일상의 소소한 순간들을 특별하게 만드는 것이 핵심입니다. 완벽함보다는 진정성 있는 모습을 보여주세요!")
    elif "beauty" in profile.business_type:
        st.info("💄 **뷰티 인플루언서 특별 팁**: 메이크업 전후 비교나 제품 사용 과정을 보여주는 콘텐츠가 높은 참여율을 만듭니다!")
    elif "fitness" in profile.business_type:
        st.info("💪 **피트니스 인플루언서 특별 팁**: 변화 과정을 꾸준히 기록하고, 팔로워들과 함께하는 챌린지를 만들어보세요!")
    
    # 권장 도구
    st.markdown("### 🛠️ 추천 도구 및 앱")
    
    tool_cols = st.columns(3)
    for i, tool in enumerate(strategy.recommended_tools):
        with tool_cols[i % 3]:
            st.info(f"📱 {tool}")
    
    # 개인 브랜드 가이드 다운로드
    st.markdown("### 📄 개인 인플루언서 가이드")
    
    brand_guide = generate_influencer_guide(profile, strategy)
    
    st.download_button(
        label="📥 나만의 인플루언서 성장 가이드 다운로드",
        data=brand_guide,
        file_name=f"influencer_growth_guide_{profile.id[:8]}.txt",
        mime="text/plain"
    )

def generate_brand_guide(profile: UserProfile, strategy: BrandStrategy) -> str:
    """브랜드 가이드 문서 생성"""
    guide = f"""
📸 INSTAGRAM 브랜딩 가이드
생성일: {datetime.now().strftime('%Y-%m-%d')}
브랜드 ID: {profile.id[:8]}

{'='*50}
🎯 브랜드 전략 개요
{'='*50}

브랜드 타입: {strategy.brand_type}
전략명: {strategy.strategy_name}
비즈니스 단계: {SURVEY_DATA['business_stages'][profile.business_stage]}
사업 분야: {SURVEY_DATA['business_types'][profile.business_type]}

{'='*50}
👥 타겟 오디언스
{'='*50}

연령대: {SURVEY_DATA['age_groups'][profile.target_age_group]}
성별 분포: {profile.target_gender}
주요 목표: {', '.join([SURVEY_DATA['primary_goals'][goal] for goal in profile.primary_goals])}

{'='*50}
🎨 브랜드 아이덴티티
{'='*50}

브랜드 아키타입: {SURVEY_DATA['brand_archetypes'][profile.brand_archetype]}

브랜드 톤앤보이스:
- 공식적(1) ←→ 캐주얼(10): {profile.tone_scores['formal_casual']}/10
- 진지함(1) ←→ 재미있음(10): {profile.tone_scores['serious_fun']}/10  
- 정중함(1) ←→ 과감함(10): {profile.tone_scores['polite_bold']}/10
- 사실적(1) ←→ 열정적(10): {profile.tone_scores['factual_passionate']}/10

{'='*50}
📋 콘텐츠 전략
{'='*50}

콘텐츠 필러:
{chr(10).join([f"{i+1}. {pillar}" for i, pillar in enumerate(strategy.content_pillars)])}

콘텐츠 믹스 비율:
{chr(10).join([f"- {format}: {ratio}%" for format, ratio in strategy.content_mix.items()])}

월간 게시 빈도:
{chr(10).join([f"- {format}: {freq}개" for format, freq in strategy.posting_frequency.items()])}

{'='*50}
🎯 성과 목표 (KPI)
{'='*50}

{chr(10).join([f"- {kpi.replace('_', ' ').title()}: {target}%" for kpi, target in strategy.kpi_targets.items()])}

{'='*50}
🛠️ 권장 도구
{'='*50}

{chr(10).join([f"- {tool}" for tool in strategy.recommended_tools])}

{'='*50}
💼 리소스 현황
{'='*50}

가용 시간: {profile.time_available}/주
예산: {profile.budget}/월
보유 도구: {', '.join(profile.tools_available) if profile.tools_available else '없음'}

{'='*50}
🏆 경쟁사 분석
{'='*50}

주요 경쟁사: {', '.join(profile.competitors) if profile.competitors else '미지정'}
차별화 포인트: {', '.join(profile.differentiation) if profile.differentiation else '미지정'}

{'='*50}
📅 주간 실행 계획 (처음 4주)
{'='*50}

{chr(10).join([f"""
Week {plan['week']}: {plan['phase']}
목표: {plan['kpi_focus']}
할 일:
{chr(10).join([f"  - {task}" for task in plan['tasks']])}
""" for plan in strategy.weekly_plans[:4]])}

{'='*50}
💡 성공을 위한 핵심 팁
{'='*50}

1. 일관성 유지: 시각적 스타일과 브랜드 보이스를 모든 콘텐츠에서 일관되게 유지하세요.

2. 참여 우선: 좋아요보다는 댓글, 저장, 공유를 유도하는 콘텐츠에 집중하세요.

3. 스토리 활용: 일상적이고 진정성 있는 모습을 스토리로 꾸준히 공유하세요.

4. 데이터 기반 의사결정: 주간 인사이트를 반드시 확인하고 전략을 조정하세요.

5. 커뮤니티 중심: 팔로워와의 진정한 소통과 관계 구축에 집중하세요.

{'='*50}
📞 지원 및 문의
{'='*50}

이 가이드는 Instagram Branding Expert 시스템에서 생성되었습니다.
추가 문의사항이나 전략 조정이 필요한 경우 언제든 새로운 분석을 실행하세요.

생성 시간: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
"""
    return guide

def show_dashboard():
    st.markdown('<div class="section-header"><h2>📈 인플루언서 성과 대시보드</h2></div>', unsafe_allow_html=True)
    
    if not st.session_state.survey_completed:
        st.warning("먼저 인플루언서 진단을 완료해주세요.")
        return
    
    # 가상 성과 데이터 (실제 구현시 Instagram API 연동)
    st.markdown("### 📊 실시간 성장 모니터링")
    
    # KPI 메트릭
    col1, col2, col3, col4 = st.columns(4)
    
    with col1:
        st.metric(
            label="팔로워 수", 
            value="2,847", 
            delta="324 (+12.8%)",
            delta_color="normal"
        )
    
    with col2:
        st.metric(
            label="평균 참여율", 
            value="4.2%", 
            delta="0.8% (+23.5%)",
            delta_color="normal"
        )
    
    with col3:
        st.metric(
            label="월간 도달률", 
            value="25,430", 
            delta="4,220 (+19.9%)",
            delta_color="normal"
        )
    
    with col4:
        st.metric(
            label="브랜드 언급", 
            value="12", 
            delta="5 (+71.4%)",
            delta_color="normal"
        )
    
    # 성과 차트
    col1, col2 = st.columns(2)
    
    with col1:
        # 팔로워 성장 추이
        if PLOTLY_AVAILABLE:
            dates = pd.date_range(start='2024-01-01', end='2024-07-24', freq='W')
            followers = [500 + i*25 + (i%3)*15 for i in range(len(dates))]
            
            fig = px.line(
                x=dates, 
                y=followers,
                title="팔로워 성장 추이",
                labels={'x': '날짜', 'y': '팔로워 수'}
            )
            fig.update_traces(line_color='#833AB4')
            st.plotly_chart(fig, use_container_width=True)
        else:
            st.markdown("#### 📈 팔로워 성장 추이")
            st.line_chart([500, 750, 1200, 1800, 2100, 2500, 2847])
    
    with col2:
        # 콘텐츠 성과 분석
        if PLOTLY_AVAILABLE:
            content_types = ['릴스', '스토리', '캐러셀', '라이브']
            engagement_rates = [4.5, 2.8, 3.2, 6.1]
            
            fig = px.bar(
                x=content_types,
                y=engagement_rates,
                title="콘텐츠 타입별 참여율",
                labels={'x': '콘텐츠 타입', 'y': '참여율 (%)'},
                color=engagement_rates,
                color_continuous_scale="Viridis"
            )
            st.plotly_chart(fig, use_container_width=True)
        else:
            st.markdown("#### 📊 콘텐츠 타입별 참여율")
            chart_data = pd.DataFrame({
                '참여율': [4.5, 2.8, 3.2, 6.1]
            }, index=['릴스', '스토리', '캐러셀', '라이브'])
            st.bar_chart(chart_data)
    
    # 주간 리포트
    st.markdown("### 📋 주간 성장 리포트")
    
    with st.expander("Week 30 (2024.07.15 - 2024.07.21) 성과 분석"):
        st.markdown("""
        #### 🎯 목표 달성 현황
        - ✅ **팔로워 증가**: 324명 (목표: 200명) - 162% 달성
        - ✅ **참여율**: 4.2% (목표: 3.5%) - 120% 달성  
        - ❌ **브랜드 언급**: 12개 (목표: 15개) - 80% 달성
        
        #### 🏆 최고 성과 콘텐츠
        1. **릴스**: "하루 루틴 GRWM" - 참여율 8.2%, 조회수 15.2K
        2. **스토리**: "팔로워 Q&A" - 완료율 78%, 답변 67개
        3. **캐러셀**: "일주일 룩북" - 참여율 5.1%, 저장 234개
        
        #### 🔧 다음 주 성장 액션 아이템
        - 브랜드 언급 증대를 위해 해시태그 전략 개선
        - 릴스 콘텐츠 비중 확대 (현재 60% → 70%)
        - 팔로워 참여 유도 콘텐츠 강화 (투표, 질문 스티커)
        """)
    
    # 성장 인사이트
    st.markdown("### 💡 AI 기반 성장 인사이트")
    
    insights = [
        {
            "우선순위": "높음",
            "분야": "콘텐츠 최적화", 
            "인사이트": "오후 7-9시 게시물이 평균 35% 높은 참여율을 보입니다",
            "액션": "주요 콘텐츠를 황금시간대에 게시"
        },
        {
            "우선순위": "중간",
            "분야": "팔로워 참여",
            "인사이트": "스토리 투표 기능 사용 시 완료율이 40% 상승합니다",
            "액션": "주간 2-3회 인터랙티브 스토리 활용"
        },
        {
            "우선순위": "중간", 
            "분야": "콘텐츠 다양성",
            "인사이트": "개인적인 스토리가 포함된 포스트의 저장률이 높습니다",
            "액션": "전문 정보 + 개인 경험담 조합 콘텐츠 확대"
        }
    ]
    
    for insight in insights:
        priority_color = {"높음": "🔴", "중간": "🟡", "낮음": "🟢"}[insight["우선순위"]]
        st.markdown(f"""
        {priority_color} **{insight['분야']}** ({insight['우선순위']} 우선순위)
        - 📊 **인사이트**: {insight['인사이트']}
        - 🎯 **액션 아이템**: {insight['액션']}
        """)
    
    # 인플루언서 성장 단계
    st.markdown("### 🚀 현재 성장 단계 및 다음 목표")
    
    current_followers = 2847
    if current_followers < 1000:
        stage = "🌱 신진 인플루언서"
        next_goal = "1K 팔로워 달성"
        advice = "일관된 콘텐츠와 해시태그 최적화에 집중하세요"
    elif current_followers < 10000:
        stage = "📈 마이크로 인플루언서"
        next_goal = "10K 팔로워 & 첫 브랜드 협찬"
        advice = "브랜드 제휴 포트폴리오 준비를 시작하세요"
    else:
        stage = "⭐ 중급 인플루언서"
        next_goal = "정기 브랜드 파트너십 확보"
        advice = "개인 브랜드 상품이나 서비스 런칭을 고려해보세요"
    
    col1, col2 = st.columns([1, 2])
    with col1:
        st.metric("현재 단계", stage)
    with col2:
        st.info(f"🎯 **다음 목표**: {next_goal}")
        st.success(f"💡 **조언**: {advice}")

def show_resources():
    st.markdown('<div class="section-header"><h2>📚 브랜딩 리소스 센터</h2></div>', unsafe_allow_html=True)
    
    # 탭으로 리소스 구분
    tab1, tab2, tab3, tab4 = st.tabs(["🛠️ 도구", "📖 가이드", "🎨 템플릿", "📊 벤치마크"])
    
    with tab1:
        st.markdown("### 🛠️ 추천 도구 및 앱")
        
        tools_categories = {
            "콘텐츠 제작": [
                {"이름": "Canva Pro", "용도": "디자인 및 템플릿", "가격": "월 12,000원", "추천도": "⭐⭐⭐⭐⭐"},
                {"이름": "VSCO", "용도": "사진 편집 및 필터", "가격": "월 19,900원", "추천도": "⭐⭐⭐⭐"},
                {"이름": "InShot", "용도": "비디오 편집", "가격": "무료/유료", "추천도": "⭐⭐⭐⭐"},
            ],
            "스케줄링": [
                {"이름": "Later", "용도": "포스트 예약 및 스케줄링", "가격": "월 $18", "추천도": "⭐⭐⭐⭐⭐"},
                {"이름": "Buffer", "용도": "소셜미디어 관리", "가격": "월 $6", "추천도": "⭐⭐⭐⭐"},
                {"이름": "Hootsuite", "용도": "다중 플랫폼 관리", "가격": "월 $49", "추천도": "⭐⭐⭐"},
            ],
            "분석": [
                {"이름": "Instagram Insights", "용도": "기본 성과 분석", "가격": "무료", "추천도": "⭐⭐⭐⭐"},
                {"이름": "Sprout Social", "용도": "고급 분석", "가격": "월 $99", "추천도": "⭐⭐⭐⭐⭐"},
                {"이름": "Iconosquare", "용도": "성과 추적", "가격": "월 $29", "추천도": "⭐⭐⭐⭐"},
            ]
        }
        
        for category, tools in tools_categories.items():
            st.markdown(f"#### {category}")
            for tool in tools:
                col1, col2, col3, col4 = st.columns([2, 2, 1, 1])
                with col1:
                    st.markdown(f"**{tool['이름']}**")
                with col2:
                    st.markdown(tool['용도'])
                with col3:
                    st.markdown(tool['가격'])
                with col4:
                    st.markdown(tool['추천도'])
            st.markdown("---")
    
    with tab2:
        st.markdown("### 📖 브랜딩 가이드")
        
        guides = [
            {
                "제목": "인스타그램 알고리즘 완전 정복 가이드",
                "설명": "2024-2025년 최신 알고리즘 변화와 대응 전략",
                "난이도": "초급-중급",
                "소요시간": "15분"
            },
            {
                "제목": "브랜드 아이덴티티 설정 워크북", 
                "설명": "체계적인 브랜드 정체성 구축 단계별 가이드",
                "난이도": "초급",
                "소요시간": "30분"
            },
            {
                "제목": "콘텐츠 기획 및 제작 마스터클래스",
                "설명": "매력적인 콘텐츠 아이디어 발굴과 제작 노하우",
                "난이도": "중급",
                "소요시간": "45분"
            },
            {
                "제목": "인플루언서 협업 전략 가이드",
                "설명": "효과적인 파트너십 구축과 ROI 측정 방법",
                "난이도": "고급", 
                "소요시간": "25분"
            }
        ]
        
        for guide in guides:
            with st.expander(f"📖 {guide['제목']}"):
                st.markdown(f"**설명**: {guide['설명']}")
                st.markdown(f"**난이도**: {guide['난이도']} | **소요시간**: {guide['소요시간']}")
                st.button(f"가이드 읽기", key=f"guide_{guide['제목']}")
    
    with tab3:
        st.markdown("### 🎨 디자인 템플릿")
        
        template_categories = {
            "포스트 템플릿": [
                "브랜드 소개 캐러셀",
                "제품 소개 템플릿", 
                "고객 후기 디자인",
                "교육 콘텐츠 레이아웃",
                "이벤트 홍보 템플릿"
            ],
            "스토리 템플릿": [
                "Q&A 스토리 템플릿",
                "비하인드 스토리 프레임",
                "제품 사용법 가이드",
                "투표 및 퀴즈 템플릿",
                "링크 스티커 디자인"
            ],
            "하이라이트 커버": [
                "미니멀 스타일",
                "브랜드 컬러 세트", 
                "아이콘 기반 디자인",
                "타이포그래피 중심",
                "일러스트 스타일"
            ]
        }
        
        for category, templates in template_categories.items():
            st.markdown(f"#### {category}")
            cols = st.columns(3)
            for i, template in enumerate(templates):
                with cols[i % 3]:
                    st.markdown(f"🎨 {template}")
                    st.button("다운로드", key=f"template_{category}_{i}")
    
    with tab4:
        st.markdown("### 📊 업계 벤치마크 데이터")
        
        # 업계별 벤치마크 차트
        benchmark_data = {
            "업계": ["패션", "뷰티", "음식", "기술", "여행", "피트니스"],
            "평균_팔로워": [15000, 25000, 8000, 12000, 18000, 22000],
            "평균_참여율": [1.8, 2.1, 2.5, 1.2, 2.0, 2.8],
            "월간_게시물": [20, 25, 15, 12, 18, 24]
        }
        
        col1, col2 = st.columns(2)
        
        with col1:
            if PLOTLY_AVAILABLE:
                fig = px.bar(
                    x=benchmark_data["업계"],
                    y=benchmark_data["평균_참여율"],
                    title="업계별 평균 참여율",
                    labels={'x': '업계', 'y': '참여율 (%)'}
                )
                st.plotly_chart(fig, use_container_width=True)
            else:
                st.markdown("#### 📊 업계별 평균 참여율")
                chart_data = pd.DataFrame({
                    '참여율': benchmark_data["평균_참여율"]
                }, index=benchmark_data["업계"])
                st.bar_chart(chart_data)
        
        with col2:
            if PLOTLY_AVAILABLE:
                fig = px.scatter(
                    x=benchmark_data["평균_팔로워"],
                    y=benchmark_data["평균_참여율"],
                    text=benchmark_data["업계"],
                    title="팔로워 수 vs 참여율",
                    labels={'x': '평균 팔로워 수', 'y': '참여율 (%)'}
                )
                fig.update_traces(textposition="top center")
                st.plotly_chart(fig, use_container_width=True)
            else:
                st.markdown("#### 📈 팔로워 수 vs 참여율")
                scatter_data = pd.DataFrame({
                    '팔로워 수': benchmark_data["평균_팔로워"],
                    '참여율': benchmark_data["평균_참여율"]
                }, index=benchmark_data["업계"])
                st.scatter_chart(scatter_data)
        
        # 성과 기준표
        st.markdown("#### 📈 성과 평가 기준표")
        
        performance_standards = pd.DataFrame({
            "지표": ["참여율", "팔로워 증가율", "도달률", "스토리 완료율"],
            "우수 (상위 10%)": ["3.0% 이상", "20% 이상", "30% 이상", "70% 이상"],
            "양호 (상위 25%)": ["2.0-3.0%", "15-20%", "20-30%", "60-70%"],
            "평균 (상위 50%)": ["1.0-2.0%", "10-15%", "10-20%", "50-60%"],
            "개선 필요": ["1.0% 미만", "10% 미만", "10% 미만", "50% 미만"]
        })
        
        st.dataframe(performance_standards, use_container_width=True)

if __name__ == "__main__":
    main()
